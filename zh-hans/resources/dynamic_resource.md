# 资源动态调整

当你在实际的生产环境使用MLSQL Stack之后，大量的MLSQL Engine会因为各种场景被部署： 有共分析师，业务探索使用的，有供作为API使用的，有做ETL引擎使用的，有做流使用的，有做机器学习平台使用的，这对服务提供方带来了大量的资源压力。比如业务探索类的，典型的上班时间资源需求大，下班时间基本上没怎么有人用，ETL则是反之，API也有一定方位。而且业务探索类的其实对响应有一定的实时需求，比如一个复杂的脚本使用者期待10s内返回，如果使用Spark 的DRA反复的资源释放和申请，可能临时申请资源的时间就已经超过10s，更不用提计算了。 这个时候我们更希望的是通过统计分析，自己制定一个资源调整策略，从而节省系统资源，减轻压力。MLSQL 为此提出这个MPIP,管理员只要通过简单的两个三个命令就可以添加或者删除CPU/内存资源。

```sql
!resource add 10c;
!resource remove 10c;
!resource set 40c;
```

第一个表示给当前正在运行的MLSQL Engine添加10个核，第二个表示减少10核，第三个则表示将当前的MLSQL Engine的资源设置为40核。

那么内存呢？内存会根据启动时配置的CPU和内存的比例，进行相应的增加或者删减。比如我们启动时，CPU和内存为1:4，那么我们添加10c,相应的，系统会自动增加40G的内存。

有了这个功能后，我们完全可以开发一个资源控制策略，对于探索类应用，每天上班时，自动增加资源，下班时剔除资源，用户也可以主动向管理员临时申请更多资源，实现真正的弹性，整个过程无需重启。